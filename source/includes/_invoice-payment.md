# Invoice Payment

## Invoice Payment Resource

The `Invoice Payment` resource represents a given payment associated with a given invoice. Kill Bill allows to have multiple partial payments against a given invoice, however in the default recurring mode for instance, the system will always attempt to make a full payment.

Partial payments can be made against unpaid - or partially paid - invoices by triggerring a payment against the `Invoice` resource -- see below. Note that, while Kill Bill supports multiple partial payments against a given invoice, the reverse is not true: A payment across multiple invoices is not (yet) supported. The description of the `System` v.s `User` generated fields below match those from the associated `Payment` and `Invoice` resources.


The attributes are the following:

* **`paymentId`** <span style="color:#32A9C7">*[System generated, immutable]*</span>. The `ID` allocated by Kill Bill upon creation.
* **`accountId`** <span style="color:#32A9C7">*[System generated, immutable]*</span>. The `ID` allocated by Kill Bill upon creation.
* **`targetInvoiceId`** <span style="color:#32A9C7">*[System generated, immutable]*</span>. The `ID` allocated by Kill Bill upon creation.
* **`paymentNumber`** <span style="color:#32A9C7">*[System generated, immutable]*</span>. Unique reference number.
* **`paymentExternalKey`** <span style="color:#32A9C7">*[User generated, default `paymentId`, immutable]*</span>. Unique key specified by the user or generated by the system.
* **`authAmount`** <span style="color:#32A9C7">*[User or system generated]*</span>. Total authorization amount across the transactions associated with the `Payment`
* **`capturedAmount`** <span style="color:#32A9C7">*[User or system generated]*</span>. Total capture amount across the transactions associated with the `Payment`
* **`purchasedAmount`** <span style="color:#32A9C7">*[User or system generated]*</span>. Total purchase amount across the transactions associated with the `Payment`
* **`refundedAmount`** <span style="color:#32A9C7">*[User or system generated]*</span>. Total refund amount across the transactions associated with the `Payment`
* **`creditedAmount`** <span style="color:#32A9C7">"*[User or system generated]*</span>. Total credit amount across the transactions associated with the `Payment`. Beware, this credit represents the actual money send back by the merchant to the user -- extremely rare --, and is unrelated to the associated invoice or account credits.
* **`currency`** <span style="color:#32A9C7">*[User or system generated]*</span>. Currency associated with the `Account`.
* **`paymentMethodId`** <span style="color:#32A9C7">*[System generated, immutable]*</span>. The `ID` of the payment method that was used to make this payment.
* **`transactions`** <span style="color:#32A9C7">*[See `PaymentTransaction` below]*</span>. A list of payment transactions, which could be of different types - e.g `PURCHASE`, `REFUND`
* **`paymentAttempts`** <span style="color:#32A9C7">*[See `PaymentAttempt` below]*</span>. A list of payment attempts when the system is configured to retry failed payments.

## Invoice Payment

### Retrieve a payment by id

**HTTP Request** 

`GET http://example.com/1.0/kb/invoicePayments/{paymentId}`

> Example Request:

```shell
curl \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'Accept: application/json' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83' 
```

```java
import org.killbill.billing.client.api.gen.InvoicePaymentApi;
protected InvoicePaymentApi invoicePaymentApi;

UUID paymentId = UUID.fromString("80f5bfca-e142-4320-b8f2-ae4530ca7172");
Boolean withPluginInfo = false; // Will not reflect plugin info
Boolean withAttempts = false; // Will not reflect payment attempts
ImmutableMap<String, String> NULL_PLUGIN_PROPERTIES = null;

InvoicePayment invoicePayment = invoicePaymentApi.getInvoicePayment(paymentId, 
                                                                    withPluginInfo,
                                                                    withAttempts,
                                                                    NULL_PLUGIN_PROPERTIES,
                                                                    AuditLevel.NONE,
                                                                    requestOptions);
```

```ruby
payment_id = '28aef37a-7655-4351-985a-02b961ae4ac7'
with_plugin_info = false
with_attempts = false

KillBillClient::Model::InvoicePayment.find_by_id(payment_id, 
                                                 with_plugin_info, 
                                                 with_attempts, 
                                                 @options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
payment_id = '5e9d8b82-2664-4a36-85a1-37471a0b618a'

invoicePaymentApi.get_invoice_payment(payment_id, api_key, api_secret)
```

> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 200 OK
<
{
  "targetInvoiceId": "4be34fe4-5845-4a35-afd8-632ad04cccf9",
  "accountId": "8b66b9f9-bfb4-463a-86c7-e267128a294a",
  "paymentId": "cc7fcd4d-e701-4679-9741-41289103db83",
  "paymentNumber": "19",
  "paymentExternalKey": "cc7fcd4d-e701-4679-9741-41289103db83",
  "authAmount": 0,
  "capturedAmount": 0,
  "purchasedAmount": 500,
  "refundedAmount": 0,
  "creditedAmount": 0,
  "currency": "USD",
  "paymentMethodId": "39f3461c-5357-42f7-a8a9-ec79502fdb6b",
  "transactions": [
    {
      "transactionId": "6787dc2d-4f5e-49b5-9764-0070fd1238c2",
      "transactionExternalKey": "6787dc2d-4f5e-49b5-9764-0070fd1238c2",
      "paymentId": "cc7fcd4d-e701-4679-9741-41289103db83",
      "paymentExternalKey": "cc7fcd4d-e701-4679-9741-41289103db83",
      "transactionType": "PURCHASE",
      "amount": 500,
      "currency": "USD",
      "effectiveDate": "2018-07-19T20:48:34.000Z",
      "processedAmount": 500,
      "processedCurrency": "USD",
      "status": "SUCCESS",
      "gatewayErrorCode": null,
      "gatewayErrorMsg": null,
      "firstPaymentReferenceId": null,
      "secondPaymentReferenceId": null,
      "properties": null,
      "auditLogs": []
    }
  ],
  "paymentAttempts": null,
  "auditLogs": []
}
```

```java
class InvoicePayment {
    org.killbill.billing.client.model.gen.InvoicePayment@47ec807
    targetInvoiceId: 8ff7ded6-e524-4f38-94f7-d9aacef8b88b
    accountId: ed1029e6-dcc0-4b1e-ae94-e00fb14efd41
    paymentId: 80f5bfca-e142-4320-b8f2-ae4530ca7172
    paymentNumber: 1
    paymentExternalKey: 80f5bfca-e142-4320-b8f2-ae4530ca7172
    authAmount: 0
    capturedAmount: 0
    purchasedAmount: 249.95
    refundedAmount: 249.95
    creditedAmount: 0
    currency: USD
    paymentMethodId: 083cc55b-65e9-484c-9c33-0d6956540a0e
    transactions: [class PaymentTransaction {
        org.killbill.billing.client.model.gen.PaymentTransaction@a0308e7f
        transactionId: b9a795f0-c9d0-4e89-a0b2-783d8844bb44
        transactionExternalKey: b9a795f0-c9d0-4e89-a0b2-783d8844bb44
        paymentId: 80f5bfca-e142-4320-b8f2-ae4530ca7172
        paymentExternalKey: 80f5bfca-e142-4320-b8f2-ae4530ca7172
        transactionType: PURCHASE
        amount: 249.95
        currency: USD
        effectiveDate: 2012-05-27T00:03:46.000Z
        processedAmount: 249.95
        processedCurrency: USD
        status: SUCCESS
        gatewayErrorCode: 
        gatewayErrorMsg: 
        firstPaymentReferenceId: null
        secondPaymentReferenceId: null
        properties: null
        auditLogs: []
    }, class PaymentTransaction {
        org.killbill.billing.client.model.gen.PaymentTransaction@c4c601f0
        transactionId: 5c59f93d-7f6d-406b-b499-7a1547c00c9f
        transactionExternalKey: f4e8c3dc-9e97-4000-b82c-1f0dcd1cf84e
        paymentId: 80f5bfca-e142-4320-b8f2-ae4530ca7172
        paymentExternalKey: 80f5bfca-e142-4320-b8f2-ae4530ca7172
        transactionType: REFUND
        amount: 249.95
        currency: USD
        effectiveDate: 2012-05-27T00:03:47.000Z
        processedAmount: 249.95
        processedCurrency: USD
        status: SUCCESS
        gatewayErrorCode: 
        gatewayErrorMsg: 
        firstPaymentReferenceId: null
        secondPaymentReferenceId: null
        properties: null
        auditLogs: []
    }]
    paymentAttempts: null
    auditLogs: []
}
```
```ruby
{
   "targetInvoiceId":"375f1ade-b4eb-4344-bb64-e44fe7a5dea1",
   "accountId":"db0d9182-c7cf-4bb7-aa3e-73a9f7105606",
   "paymentId":"28aef37a-7655-4351-985a-02b961ae4ac7",
   "paymentNumber":"595",
   "paymentExternalKey":"28aef37a-7655-4351-985a-02b961ae4ac7",
   "authAmount":0,
   "capturedAmount":0,
   "purchasedAmount":50.0,
   "refundedAmount":0,
   "creditedAmount":0,
   "currency":"USD",
   "paymentMethodId":"0e47ceb2-8cfc-4005-86ac-5fe88ecce8ce",
   "transactions":[
      {
         "transactionId":"37c0189d-737c-435c-bfbd-944aabe27d1b",
         "transactionExternalKey":"37c0189d-737c-435c-bfbd-944aabe27d1b",
         "paymentId":"28aef37a-7655-4351-985a-02b961ae4ac7",
         "paymentExternalKey":"28aef37a-7655-4351-985a-02b961ae4ac7",
         "transactionType":"PURCHASE",
         "amount":50.0,
         "currency":"USD",
         "effectiveDate":"2013-08-01T06:00:02.000Z",
         "processedAmount":50.0,
         "processedCurrency":"USD",
         "status":"SUCCESS",
         "auditLogs":[]
      }
   ],
   "auditLogs":[]
}
```
```python
{'account_id': '8a758318-25fb-46e1-a385-a8f8354ec903',
 'audit_logs': [],
 'auth_amount': 0.0,
 'captured_amount': 0.0,
 'credited_amount': 0.0,
 'currency': 'USD',
 'payment_attempts': None,
 'payment_external_key': '5e9d8b82-2664-4a36-85a1-37471a0b618a',
 'payment_id': '5e9d8b82-2664-4a36-85a1-37471a0b618a',
 'payment_method_id': 'eb737a51-d230-46fe-ad95-8ddf0b8effe3',
 'payment_number': '337',
 'purchased_amount': 50.0,
 'refunded_amount': 0.0,
 'target_invoice_id': '8291871e-b16e-45e6-a971-577d44727327',
 'transactions': [{'amount': 50.0,
                   'audit_logs': [],
                   'currency': 'USD',
                   'effective_date': datetime.datetime(2018, 5, 9, 14, 27, 9, tzinfo=tzutc()),
                   'first_payment_reference_id': None,
                   'gateway_error_code': None,
                   'gateway_error_msg': None,
                   'payment_external_key': '5e9d8b82-2664-4a36-85a1-37471a0b618a',
                   'payment_id': '5e9d8b82-2664-4a36-85a1-37471a0b618a',
                   'processed_amount': 50.0,
                   'processed_currency': 'USD',
                   'properties': None,
                   'second_payment_reference_id': None,
                   'status': 'SUCCESS',
                   'transaction_external_key': '70a36a47-878e-4fd8-8401-1ab2f4403d41',
                   'transaction_id': '70a36a47-878e-4fd8-8401-1ab2f4403d41',
                   'transaction_type': 'PURCHASE'}]}
```

**Query Parameters**

| Name | Type | Required | Description |
| ---- | -----| -------- | ----------- |
| **withPluginInfo** | boolean | true | choose true if you want plugin info  (default: false)|
| **withAttempts** | boolean | true | choose true if you want payment attempts  (default: false)|

**Returns**

Returns a invoice payment object.

### Refund a payment, and adjust the invoice if needed

**HTTP Request** 

`POST http://example.com/1.0/kb/invoicePayments/{paymentId}/refunds`

> Example Request:

```shell
curl -v \
    -X POST \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'Content-Type: application/json' \
    -H 'X-Killbill-CreatedBy: demo' \
    -d '{
          "paymentId": "cc7fcd4d-e701-4679-9741-41289103db83",
          "amount": 50,
          "currency": "USD"
        }' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/refunds' 
```

```java
import org.killbill.billing.client.api.gen.InvoicePaymentApi;
protected InvoicePaymentApi invoicePaymentApi;

UUID paymentId = UUID.fromString("45d6f4c5-21be-49b1-99c5-7b0c3c985bf0");

InvoicePaymentTransaction refund = new InvoicePaymentTransaction();
refund.setPaymentId(paymentId);
refund.setAmount(BigDecimal.ONE);

UUID paymentMethodId = UUID.fromString("28a3ed1a-7a58-4ac2-b864-2ca723abb864");

ImmutableMap<String, String> NULL_PLUGIN_PROPERTIES = null;

invoicePaymentApi.createRefundWithAdjustments(paymentId, 
                                              refund, 
                                              paymentMethodId, 
                                              NULL_PLUGIN_PROPERTIES, 
                                              requestOptions);
```

```ruby
payment_id = '8d85a8e8-c94b-438f-aac1-e8cb436b2c05'
amount ='50.0'
adjustments = nil
KillBillClient::Model::InvoicePayment.refund(payment_id, 
                                             amount, 
                                             adjustments, 
                                             user, 
                                             reason, 
                                             comment, 
                                             options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
payment_id = '8d85a8e8-c94b-438f-aac1-e8cb436b2c05'
body = PaymentTransaction(amount=50.0)

invoicePaymentApi.create_refund_with_adjustments(payment_id,
                                                 body,
                                                 created_by,
                                                 api_key,
                                                 api_secret)
```
> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 201 Created
< Location: http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/
< Content-Type: application/json
< Content-Length: 0
```

```java
class InvoicePayment {
    org.killbill.billing.client.model.gen.InvoicePayment@916e89e1
    targetInvoiceId: 5de44543-2cd9-4781-b6a3-12c47a9244ed
    accountId: 9b535e8a-dbfe-479a-8936-75c8b5e9cf45
    paymentId: 45d6f4c5-21be-49b1-99c5-7b0c3c985bf0
    paymentNumber: 1
    paymentExternalKey: 45d6f4c5-21be-49b1-99c5-7b0c3c985bf0
    authAmount: 0
    capturedAmount: 0
    purchasedAmount: 249.95
    refundedAmount: 1
    creditedAmount: 0
    currency: USD
    paymentMethodId: 28a3ed1a-7a58-4ac2-b864-2ca723abb864
    transactions: [class PaymentTransaction {
        org.killbill.billing.client.model.gen.PaymentTransaction@ab430f5e
        transactionId: 6727a8db-ec00-4d85-89f2-cda778b21ddf
        transactionExternalKey: 6727a8db-ec00-4d85-89f2-cda778b21ddf
        paymentId: 45d6f4c5-21be-49b1-99c5-7b0c3c985bf0
        paymentExternalKey: 45d6f4c5-21be-49b1-99c5-7b0c3c985bf0
        transactionType: PURCHASE
        amount: 249.95
        currency: USD
        effectiveDate: 2012-09-26T00:00:05.000Z
        processedAmount: 249.95
        processedCurrency: USD
        status: SUCCESS
        gatewayErrorCode: 
        gatewayErrorMsg: 
        firstPaymentReferenceId: null
        secondPaymentReferenceId: null
        properties: null
        auditLogs: []
    }, class PaymentTransaction {
        org.killbill.billing.client.model.gen.PaymentTransaction@d404a66c
        transactionId: a29e0204-a4db-400f-9f5f-3de1e57169d8
        transactionExternalKey: b4903f2e-ea23-4c95-a2c8-a3d81b7dfd60
        paymentId: 45d6f4c5-21be-49b1-99c5-7b0c3c985bf0
        paymentExternalKey: 45d6f4c5-21be-49b1-99c5-7b0c3c985bf0
        transactionType: REFUND
        amount: 1
        currency: USD
        effectiveDate: 2012-09-26T00:00:10.000Z
        processedAmount: 1
        processedCurrency: USD
        status: SUCCESS
        gatewayErrorCode: 
        gatewayErrorMsg: 
        firstPaymentReferenceId: null
        secondPaymentReferenceId: null
        properties: null
        auditLogs: []
    }]
    paymentAttempts: null
    auditLogs: []
}
```
```ruby
{
   "targetInvoiceId":"045900ff-5b2a-4709-b7bd-d70501998dd5",
   "accountId":"dc7d2b03-d989-4cfa-96db-f02b6475950e",
   "paymentId":"8d85a8e8-c94b-438f-aac1-e8cb436b2c05",
   "paymentNumber":"347",
   "paymentExternalKey":"8d85a8e8-c94b-438f-aac1-e8cb436b2c05",
   "authAmount":0,
   "capturedAmount":0,
   "purchasedAmount":50.0,
   "refundedAmount":20.0,
   "creditedAmount":0,
   "currency":"USD",
   "paymentMethodId":"4103cf10-08b4-4685-b3c2-1c2c88b0f32f",
   "transactions":[
      {
         "transactionId":"1cd767ed-b3c1-4369-a447-09308f3bebf4",
         "transactionExternalKey":"1cd767ed-b3c1-4369-a447-09308f3bebf4",
         "paymentId":"8d85a8e8-c94b-438f-aac1-e8cb436b2c05",
         "paymentExternalKey":"8d85a8e8-c94b-438f-aac1-e8cb436b2c05",
         "transactionType":"PURCHASE",
         "amount":50.0,
         "currency":"USD",
         "effectiveDate":"2013-08-01T06:00:02.000Z",
         "processedAmount":50.0,
         "processedCurrency":"USD",
         "status":"SUCCESS",
         "auditLogs":[]
      },
      {
         "transactionId":"69f72535-dd5d-4784-b0a6-05d6f64359cf",
         "transactionExternalKey":"d7118799-0268-45c9-a0e0-455fa2731a8b",
         "paymentId":"8d85a8e8-c94b-438f-aac1-e8cb436b2c05",
         "paymentExternalKey":"8d85a8e8-c94b-438f-aac1-e8cb436b2c05",
         "transactionType":"REFUND",
         "amount":20.0,
         "currency":"USD",
         "effectiveDate":"2013-08-01T06:00:03.000Z",
         "processedAmount":20.0,
         "processedCurrency":"USD",
         "status":"SUCCESS",
         "auditLogs":[]
      }
   ],
   "auditLogs":[]
}
```
```python
no content
```

**Query Parameters**

| Name | Type | Required | Description |
| ---- | -----| -------- | ----------- | 
| **externalPayment** | boolean | false | choose true if the payment method is external |
| **paymentMethodId** | string | false | payment method id |

**Returns**

Returns a invoice payment object.

### Record a chargeback

**HTTP Request** 

`POST http://example.com/1.0/kb/invoicePayments/{paymentId}/chargebacks`

> Example Request:

```shell
curl -v \
    -X POST \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'Content-Type: application/json' \
    -H 'X-Killbill-CreatedBy: demo' \
    -d '{
          "paymentId": "cc7fcd4d-e701-4679-9741-41289103db83",
          "amount": 5,
          "currency": "USD"
        }' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/chargebacks' 
```

```java
import org.killbill.billing.client.api.gen.InvoicePaymentApi;
protected InvoicePaymentApi invoicePaymentApi;

UUID paymentId = UUID.fromString("96930ff3-82e1-4556-888a-0cb07ec120d6");

InvoicePaymentTransaction body = new InvoicePaymentTransaction();
body.setPaymentId(paymentId);
body.setAmount(new BigDecimal("50.00"));

InvoicePayment result = invoicePaymentApi.createChargeback(paymentId, 
                                                           body, 
                                                           requestOptions);
```

```ruby
payment_id = '2276b3c9-4e51-41b2-b5bf-9ddc11582ee4'
amount = '50.0'
currency = 'USD'
effective_date = "2013-08-01"

KillBillClient::Model::InvoicePayment.chargeback(payment_id, 
                                                 amount,
                                                 currency,
                                                 effective_date,
                                                 user, 
                                                 reason,
                                                 comment, 
                                                 options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
payment_id = '2276b3c9-4e51-41b2-b5bf-9ddc11582ee4'
body = PaymentTransaction(amount=50.0, currency='USD')

invoicePaymentApi.create_chargeback(payment_id, 
                                    body, 
                                    created_by, 
                                    api_key, 
                                    api_secret)
```

> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 201 Created
< Location: http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/
< Content-Type: application/json
< Content-Length: 0
```

```java
class InvoicePayment {
    org.killbill.billing.client.model.gen.InvoicePayment@e920eb58
    targetInvoiceId: 84ae9d9a-badf-45c2-b53b-7b8a077e42ea
    accountId: 4dd59373-be7a-409e-beaa-a17e8b234591
    paymentId: 96930ff3-82e1-4556-888a-0cb07ec120d6
    paymentNumber: 1
    paymentExternalKey: 96930ff3-82e1-4556-888a-0cb07ec120d6
    authAmount: 0
    capturedAmount: 0
    purchasedAmount: 0.00
    refundedAmount: 0
    creditedAmount: 0
    currency: USD
    paymentMethodId: a9408abd-d505-4462-afe6-0d29a202d8b3
    transactions: [class PaymentTransaction {
        org.killbill.billing.client.model.gen.PaymentTransaction@e72668f3
        transactionId: 583ba30d-c6f4-4600-934e-73ef9782e444
        transactionExternalKey: 583ba30d-c6f4-4600-934e-73ef9782e444
        paymentId: 96930ff3-82e1-4556-888a-0cb07ec120d6
        paymentExternalKey: 96930ff3-82e1-4556-888a-0cb07ec120d6
        transactionType: PURCHASE
        amount: 249.95
        currency: USD
        effectiveDate: 2012-09-26T00:00:08.000Z
        processedAmount: 249.95
        processedCurrency: USD
        status: SUCCESS
        gatewayErrorCode: 
        gatewayErrorMsg: 
        firstPaymentReferenceId: null
        secondPaymentReferenceId: null
        properties: null
        auditLogs: []
    }]
    paymentAttempts: null
    auditLogs: []
}
```
```ruby
{
   "targetInvoiceId":"dd185d1c-a4c5-4420-b06a-df42af446975",
   "accountId":"bb43a670-c644-4121-a981-ba5f5dac3b94",
   "paymentId":"2276b3c9-4e51-41b2-b5bf-9ddc11582ee4",
   "paymentNumber":"339",
   "paymentExternalKey":"2276b3c9-4e51-41b2-b5bf-9ddc11582ee4",
   "authAmount":0,
   "capturedAmount":0,
   "purchasedAmount":0.0,
   "refundedAmount":0,
   "creditedAmount":0,
   "currency":"USD",
   "paymentMethodId":"a9e97ad3-ef17-4475-8464-25d09e3b5290",
   "transactions":[
      {
         "transactionId":"49eff7ec-2982-428a-b4f0-ed99dcbfbb82",
         "transactionExternalKey":"49eff7ec-2982-428a-b4f0-ed99dcbfbb82",
         "paymentId":"2276b3c9-4e51-41b2-b5bf-9ddc11582ee4",
         "paymentExternalKey":"2276b3c9-4e51-41b2-b5bf-9ddc11582ee4",
         "transactionType":"PURCHASE",
         "amount":50.0,
         "currency":"USD",
         "effectiveDate":"2013-08-01T06:00:02.000Z",
         "processedAmount":50.0,
         "processedCurrency":"USD",
         "status":"SUCCESS",
         "auditLogs":[]
      },
      {
         "transactionId":"16d55de4-5dd8-4306-87c3-d05db796d90f",
         "transactionExternalKey":"d18943b1-96b7-49fd-9f11-78d55f361b18",
         "paymentId":"2276b3c9-4e51-41b2-b5bf-9ddc11582ee4",
         "paymentExternalKey":"2276b3c9-4e51-41b2-b5bf-9ddc11582ee4",
         "transactionType":"CHARGEBACK",
         "amount":50.0,
         "currency":"USD",
         "effectiveDate":"2013-08-01T06:00:03.000Z",
         "processedAmount":50.0,
         "processedCurrency":"USD",
         "status":"SUCCESS",
         "auditLogs":[]
      }
   ],
   "auditLogs":[]
}
```
```python
no content
```

**Query Parameters**

None.

**Returns**

Returns a invoice payment object.

### Complete an existing transaction

**HTTP Request** 

`PUT http://example.com/1.0/kb/invoicePayments/{paymentId}`

> Example Request:

```shell
curl -v \
    -X PUT \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'Content-Type: application/json' \
    -H 'X-Killbill-CreatedBy: demo' \
    -d '{
            "paymentId": "cc7fcd4d-e701-4679-9741-41289103db83"
        }' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83' 
```

```java
import org.killbill.billing.client.api.gen.InvoicePaymentApi;
protected InvoicePaymentApi invoicePaymentApi;

UUID paymentId = UUID.fromString("80f5bfca-e142-4320-b8f2-ae4530ca7172");
PaymentTransaction body = new PaymentTransaction();
ImmutableList<String> NULL_PLUGIN_NAMES = null;
ImmutableMap<String, String> NULL_PLUGIN_PROPERTIES = null;

invoicePaymentApi.completeInvoicePaymentTransaction(paymentId, 
                                                    body, 
                                                    NULL_PLUGIN_NAMES, 
                                                    NULL_PLUGIN_PROPERTIES, 
                                                    requestOptions);
```

```ruby
payment_id = '2276b3c9-4e51-41b2-b5bf-9ddc11582ee4'

KillBillClient::Model::InvoicePayment.complete_invoice_payment_transaction(payment_id, 
                                                                           user, 
                                                                           reason, 
                                                                           comment, 
                                                                           options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
body = PaymentTransaction(payment_id=payment_id)

invoicePaymentApi.complete_invoice_payment_transaction(payment_id, 
                                                       body, 
                                                       created_by, 
                                                       api_key, 
                                                       api_secret)
```

> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 204 No Content
< Content-Type: application/json
< Content-Length: 0
```

```java
no content
```
```ruby
no content
```
```python
no content
```

**Query Parameters**

None.

**Returns**

A `204` http status without content.


### Record a chargeback reversal

**HTTP Request** 

`POST http://example.com/1.0/kb/invoicePayments/{paymentId}/chargebackReversals`

> Example Request:

```shell
curl -v \
    -X POST \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'Content-Type: application/json' \
    -H 'X-Killbill-CreatedBy: demo' \
    -d '{
          "transactionExternalKey": "a335f7d2-e115-436f-8c63-2b0114d974de",
          "paymentId": "cc7fcd4d-e701-4679-9741-41289103db83",
          "effectiveDate": "2018-07-20T15:05:36.853Z"        
        }' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/chargebackReversals' 
```

```java
TODO
```

```ruby
payment_id = '7a5d4997-5d44-4a82-8371-a410ea5615f4'
chargeback_transaction_external_key = '99c45d07-abe4-4bc7-a207-0524548c1b08'
effective_date = "2013-08-01"

KillBillClient::Model::InvoicePayment.chargeback_reversal(payment_id,
                                                          chargeback_transaction_external_key, 
                                                          effective_date, 
                                                          user, 
                                                          reason, 
                                                          comment, 
                                                          options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
payment_id = '7a5d4997-5d44-4a82-8371-a410ea5615f4'
transaction_external_key = '99c45d07-abe4-4bc7-a207-0524548c1b08'
body = PaymentTransaction(amount=50.0, 
                          currency='USD', 
                          transaction_external_key=transaction_external_key)

invoicePaymentApi.create_chargeback_reversal(payment_id, 
                                             body, 
                                             created_by, 
                                             api_key, 
                                             api_secret)
```

> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 201 Created
< Location: http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/
< Content-Type: application/json
< Content-Length: 0
```

```ruby
{
   "targetInvoiceId":"dee84f4e-5781-442c-845e-423a6bcb6b2b",
   "accountId":"93182158-c000-4c8d-893e-1e758e975a2a",
   "paymentId":"7a5d4997-5d44-4a82-8371-a410ea5615f4",
   "paymentNumber":"338",
   "paymentExternalKey":"7a5d4997-5d44-4a82-8371-a410ea5615f4",
   "authAmount":0,
   "capturedAmount":0,
   "purchasedAmount":50.0,
   "refundedAmount":0,
   "creditedAmount":0,
   "currency":"USD",
   "paymentMethodId":"5d32f8f4-24b1-4519-85e4-356b5c087f76",
   "transactions":[
      {
         "transactionId":"ef824f7f-30f6-4b08-82d4-5add7e7a773f",
         "transactionExternalKey":"ef824f7f-30f6-4b08-82d4-5add7e7a773f",
         "paymentId":"7a5d4997-5d44-4a82-8371-a410ea5615f4",
         "paymentExternalKey":"7a5d4997-5d44-4a82-8371-a410ea5615f4",
         "transactionType":"PURCHASE",
         "amount":50.0,
         "currency":"USD",
         "effectiveDate":"2013-08-01T06:00:02.000Z",
         "processedAmount":50.0,
         "processedCurrency":"USD",
         "status":"SUCCESS",
         "auditLogs":[]
      },
      {
         "transactionId":"90fef451-10d6-4ebd-a126-43c3ab4315c2",
         "transactionExternalKey":"99c45d07-abe4-4bc7-a207-0524548c1b08",
         "paymentId":"7a5d4997-5d44-4a82-8371-a410ea5615f4",
         "paymentExternalKey":"7a5d4997-5d44-4a82-8371-a410ea5615f4",
         "transactionType":"CHARGEBACK",
         "amount":50.0,
         "currency":"USD",
         "effectiveDate":"2013-08-01T06:00:04.000Z",
         "processedAmount":50.0,
         "processedCurrency":"USD",
         "status":"SUCCESS",
         "auditLogs":[]
      },
      {
         "transactionId":"a1c3648c-f3c0-4c0f-9eb0-e56c7ab9c798",
         "transactionExternalKey":"99c45d07-abe4-4bc7-a207-0524548c1b08",
         "paymentId":"7a5d4997-5d44-4a82-8371-a410ea5615f4",
         "paymentExternalKey":"7a5d4997-5d44-4a82-8371-a410ea5615f4",
         "transactionType":"CHARGEBACK",
         "effectiveDate":"2013-08-01T06:00:05.000Z",
         "processedAmount":0.0,
         "status":"PAYMENT_FAILURE",
         "auditLogs":[]
      }
   ],
   "auditLogs":[]
}
```
```python
no content
```

**Query Parameters**

None.

**Returns**

Returns a invoice payment object.

## Custom Fields

### Add custom fields to payment

**HTTP Request** 

`POST http://example.com/1.0/kb/invoicePayments/{paymentId}/customFields`

> Example Request:

```shell
curl -v \
    -X POST \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'Content-Type: application/json' \
    -H 'X-Killbill-CreatedBy: demo' \
    -d '[{ 
            "objectId": "2495e35e-2b96-434c-8877-62dbbf20f7e9",
            "objectType": "INVOICE_PAYMENT",
            "name": "Test Custom Fields",
            "value": "test_value"
    }]' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/2495e35e-2b96-434c-8877-62dbbf20f7e9/customFields' 
```

```java
import org.killbill.billing.client.api.gen.InvoicePaymentApi;
protected InvoicePaymentApi invoicePaymentApi;

UUID paymentId = UUID.fromString("59860a0d-c032-456d-a35e-3a48fe8579e5");
final ImmutableList<AuditLog> EMPTY_AUDIT_LOGS = ImmutableList.<AuditLog>of();

CustomFields customFields = new CustomFields();
customFields.add(new CustomField(null, 
                                 paymentId, 
                                 ObjectType.INVOICE_PAYMENT, 
                                 "Test Custom Field", 
                                 "test_value", 
                                 EMPTY_AUDIT_LOGS));

invoicePaymentApi.createInvoicePaymentCustomFields(paymentId, 
                                                   customFields, 
                                                   requestOptions);
```

```ruby
custom_field = KillBillClient::Model::CustomFieldAttributes.new
custom_field.object_type = 'INVOICE_PAYMENT'
custom_field.name = 'Test Custom Field'
custom_field.value = 'test_value'

invoice_payment.add_custom_field(custom_field, 
                                 user,
                                 reason,
                                 comment,
                                 options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
body = CustomField(name='Test Custom Field', value='test_value')

invoicePaymentApi.create_invoice_payment_custom_fields(payment_id,
                                                       [body],
                                                       created_by,
                                                       api_key,
                                                       api_secret)

```
> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 201 Created
< Location: http://127.0.0.1:8080/1.0/kb/invoicePayments/2495e35e-2b96-434c-8877-62dbbf20f7e9/customFields
< Content-Type: application/json
< Content-Length: 0
```

```java
//First element of the list
class CustomField {
    org.killbill.billing.client.model.gen.CustomField@c7d0c38a
    customFieldId: null
    objectId: 59860a0d-c032-456d-a35e-3a48fe8579e5
    objectType: INVOICE_PAYMENT
    name: Test Custom Field
    value: test_value
    auditLogs: []
}
```
```ruby
[
   {
      "customFieldId":"7fb3dde7-0911-4477-99e3-69d142509bb9",
      "objectId":"4927c1a2-3959-4f71-98e7-ce3ba19c92ac",
      "objectType":"INVOICE_PAYMENT",
      "name":"Test Custom Field",
      "value":"test_value",
      "auditLogs":[]
   }
]
```
```python
no content
```

**Query Parameters**

None.

**Returns**

Returns a custom field object.

### Retrieve payment custom fields

**HTTP Request** 

`GET http://example.com/1.0/kb/invoicePayments/{paymentId}/customFields`

> Example Request:

```shell
curl \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'Accept: application/json' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/2495e35e-2b96-434c-8877-62dbbf20f7e9/customFields' 
```

```java
import org.killbill.billing.client.api.gen.InvoicePaymentApi;
protected InvoicePaymentApi invoicePaymentApi;

UUID paymentId = UUID.fromString("59860a0d-c032-456d-a35e-3a48fe8579e5");

List<CustomField> customFields = invoicePaymentApi.getInvoicePaymentCustomFields(paymentId,
                                                                                 AuditLevel.NONE,
                                                                                 requestOptions);
```

```ruby
audit = 'NONE'

invoice_payment.custom_fields(audit, options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
payment_id = 'f33e0adc-78df-438a-b920-aaacd7f8597a'

invoicePaymentApi.get_invoice_payment_custom_fields(payment_id, api_key, api_secret)
```

> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 200 OK
<
[
  {
    "customFieldId": "3fbf75aa-6f22-4a02-974b-55eeded2cf6b",
    "objectId": "2495e35e-2b96-434c-8877-62dbbf20f7e9",
    "objectType": "PAYMENT",
    "name": "Test Custom Field",
    "value": "test_value",
    "auditLogs": []
  }
]
```

```java
//First element of the list
class CustomField {
    org.killbill.billing.client.model.gen.CustomField@c7d0c38a
    customFieldId: null
    objectId: 59860a0d-c032-456d-a35e-3a48fe8579e5
    objectType: INVOICE_PAYMENT
    name: Test Custom Field
    value: test_value
    auditLogs: []
}
```
```ruby
[
   {
      "customFieldId":"7fb3dde7-0911-4477-99e3-69d142509bb9",
      "objectId":"4927c1a2-3959-4f71-98e7-ce3ba19c92ac",
      "objectType":"INVOICE_PAYMENT",
      "name":"Test Custom Field",
      "value":"test_value",
      "auditLogs":[]
   }
]
```
```python
[{'audit_logs': [],
 'custom_field_id': '9913e0f6-b5ef-498b-ac47-60e1626eba8f',
 'name': 'Test Custom Field',
 'object_id': 'f33e0adc-78df-438a-b920-aaacd7f8597a',
 'object_type': 'PAYMENT',
 'value': 'test_value'}]
```

**Query Parameters**

| Name | Type | Required | Description |
| ---- | -----| -------- | ----------- | 
| **audit** | enum | false | level of audit logs returned |

**Returns**

Returns a list of custom field objects.

### Modify custom fields to payment

**HTTP Request** 

`PUT http://example.com/1.0/kb/invoicePayments/{paymentId}/customFields`

> Example Request:

```shell
curl -v \
    -X PUT \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'Content-Type: application/json' \
    -H 'X-Killbill-CreatedBy: demo' \
    -d '[{ 
            "customFieldId": "e2408cac-931b-43eb-855b-9f2902615c39",
            "value": "NewValue"
    }]' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/2495e35e-2b96-434c-8877-62dbbf20f7e9/customFields' 
```

```java
import org.killbill.billing.client.api.gen.InvoicePaymentApi;
protected InvoicePaymentApi invoicePaymentApi;

UUID paymentId = UUID.fromString("59860a0d-c032-456d-a35e-3a48fe8579e5");
UUID customFieldsId = UUID.fromString("9913e0f6-b5ef-498b-ac47-60e1626eba8f");

CustomField customFieldModified = new CustomField();
customFieldModified.setCustomFieldId(customFieldsId);
customFieldModified.setValue("NewValue");

invoicePaymentApi.modifyInvoicePaymentCustomFields(paymentId, 
                                                   customFieldModified, 
                                                   requestOptions);
```

```ruby
custom_field.custom_field_id = '7fb3dde7-0911-4477-99e3-69d142509bb9'
custom_field.name = 'Test Modify'
custom_field.value = 'test_modify_value'

invoice_payment.modify_custom_field(custom_field,                                                                                            
                                    user, 
                                    reason,
                                    comment, 
                                    options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
payment_id = 'f33e0adc-78df-438a-b920-aaacd7f8597a'
custom_field_id = '9913e0f6-b5ef-498b-ac47-60e1626eba8f'
body = CustomField(custom_field_id=custom_field_id, name='Test Modify', value='test_modify_value')

invoicePaymentApi.modify_invoice_payment_custom_fields(payment_id,
                                                       [body],
                                                       created_by,
                                                       api_key,
                                                       api_secret)
```

> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 204 No Content
< Content-Type: application/json
< Content-Length: 0
```

```java
no content
```
```ruby
no content
```
```python
no content
```


**Query Parameters**

| Name | Type | Required | Description |
| ---- | -----| -------- | ----------- | 
| **customFieldList** | string | true | a list of custom field objects that you want to modify |

**Returns**

A `204` http status without content.

### Remove custom fields from payment

**HTTP Request** 

`DELETE http://example.com/1.0/kb/invoicePayments/{paymentId}/customFields`

> Example Request:

```shell
curl -v \
    -X DELETE \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'X-Killbill-CreatedBy: demo' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/2495e35e-2b96-434c-8877-62dbbf20f7e9/customFields?customField=e2408cac-931b-43eb-855b-9f2902615c39' 
```

```java
import org.killbill.billing.client.api.gen.InvoicePaymentApi;
protected InvoicePaymentApi invoicePaymentApi;

UUID paymentId = UUID.fromString("59860a0d-c032-456d-a35e-3a48fe8579e5");
UUID customFieldsId = UUID.fromString("9913e0f6-b5ef-498b-ac47-60e1626eba8f");

invoicePaymentApi.deleteInvoicePaymentCustomFields(paymentId, 
                                                   customFieldsId, 
                                                   requestOptions);
```

```ruby
custom_field_id = custom_field.id

invoice_payment.remove_custom_field(custom_field_id,                                                                                            
                                    user, 
                                    reason,
                                    comment, 
                                    options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
payment_id = 'f33e0adc-78df-438a-b920-aaacd7f8597a'
custom_field_id = '9913e0f6-b5ef-498b-ac47-60e1626eba8f'
custom_field = [custom_field_id]
invoicePaymentApi.delete_invoice_payment_custom_fields(payment_id,
                                                       created_by,
                                                       api_key,
                                                       api_secret,
                                                       custom_field=custom_field)
```
> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 204 No Content
< Content-Type: application/json
< Content-Length: 0
```

```java
no content
```
```ruby
no content
```
```python
no content
```

**Query Parameters**

| Name | Type | Required | Description |
| ---- | -----| -------- | ----------- | 
| **customFieldList** | string | true | a list of custom field objects that you want to remove it |

**Returns**

A `204` http status without content.

## Tags

### Add tags to payment

**HTTP Request** 

`POST http://example.com/1.0/kb/invoicePayments/{paymentId}/tags`

> Example Request:

```shell
curl -v \
    -X POST \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'Content-Type: application/json' \
    -H 'X-Killbill-CreatedBy: demo' \
    -d '[
            "00000000-0000-0000-0000-000000000001"
        ]' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/tags' 
```

```java
import org.killbill.billing.client.api.gen.InvoicePaymentApi;
protected InvoicePaymentApi invoicePaymentApi;

UUID paymentId = UUID.fromString("45d6f4c5-21be-49b1-99c5-7b0c3c985bf0");

UUID autoPayOffId = UUID.fromString("00000000-0000-0000-0000-000000000001");

Tags result = invoicePaymentApi.createInvoicePaymentTags(paymentId, 
                                                         ImmutableList.<UUID>of(autoPayOffId), 
                                                         requestOptions);
```

```ruby
tag_name = 'TEST'

invoice_payment.add_tag(tag_name,
                        user,
                        reason,
                        comment,
                        options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
payment_id = '8d85a8e8-c94b-438f-aac1-e8cb436b2c05'
tag = ["00000000-0000-0000-0000-000000000002"]

invoicePaymentApi.create_invoice_payment_tags(payment_id,
                                              tag,
                                              created_by,
                                              api_key,
                                              api_secret)
```

> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 201 Created
< Location: http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/tags
< Content-Type: application/json
< Content-Length: 0
```

```java
//First element of the list
class Tag {
    org.killbill.billing.client.model.gen.Tag@bd138472
    tagId: 1bb4b638-3886-4f73-90a5-89eb6d1bcf7f
    objectType: INVOICE_PAYMENT
    objectId: 45d6f4c5-21be-49b1-99c5-7b0c3c985bf0
    tagDefinitionId: 00000000-0000-0000-0000-000000000001
    tagDefinitionName: AUTO_PAY_OFF
    auditLogs: []
}
```
```ruby
[
   {
      "tagId":"a46cfeb6-e175-42db-be62-7f117326ab4e",
      "objectType":"INVOICE_PAYMENT",
      "objectId":"28af3cb9-275b-4ac4-a55d-a0536e479069",
      "tagDefinitionId":"00000000-0000-0000-0000-000000000006",
      "tagDefinitionName":"TEST",
      "auditLogs":[]
   }
]
```
```python
no content
```

**Query Parameters**

| Name | Type | Required | Description |
| ---- | -----| -------- | ---- | ------------
| **tagDef** | string | true | list with tag definition id's to add |

**Returns**

A `201` http status without content.

### Retrieve payment tags

**HTTP Request** 

`GET http://example.com/1.0/kb/invoicePayments/{paymentId}/tags`

> Example Request:

```shell
curl \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'Accept: application/json' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/tags' 
```

```java
import org.killbill.billing.client.api.gen.InvoicePaymentApi;
protected InvoicePaymentApi invoicePaymentApi;

UUID paymentId = UUID.fromString("e659f0f3-745c-46d5-953c-28fe9282fc7d");

Boolean includedDeleted = false; // Will not include deleted tags

List<Tag> tags = invoicePaymentApi.getInvoicePaymentTags(paymentId, 
                                                         includedDeleted, 
                                                         AuditLevel.FULL, 
                                                         requestOptions);
```

```ruby
included_deleted = false
audit = 'NONE'

invoice_payment.tags(included_deleted,
                     audit,
                     options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
payment_id = '2a1ffd2c-0de1-4f5c-b2a9-27d8deebe596'

invoicePaymentApi.get_invoice_payment_tags(payment_id, api_key, api_secret)
```

> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 200 OK
<
[
  {
    "tagId": "e7f68cab-3b9a-4150-909a-5f1c17f1fb2b",
    "objectType": "PAYMENT",
    "objectId": "cc7fcd4d-e701-4679-9741-41289103db83",
    "tagDefinitionId": "00000000-0000-0000-0000-000000000001",
    "tagDefinitionName": "AUTO_PAY_OFF",
    "auditLogs": []
  }
]
```

```java
//First element of the list
class Tag {
    org.killbill.billing.client.model.gen.Tag@cae768d7
    tagId: d724f79d-fad1-4758-b35e-d62708450d90
    objectType: INVOICE_PAYMENT
    objectId: e659f0f3-745c-46d5-953c-28fe9282fc7d
    tagDefinitionId: 00000000-0000-0000-0000-000000000001
    tagDefinitionName: AUTO_PAY_OFF
    auditLogs: [class AuditLog {
        changeType: INSERT
        changeDate: 2012-08-25T00:00:02.000Z
        objectType: TAG
        objectId: d724f79d-fad1-4758-b35e-d62708450d90
        changedBy: Toto
        reasonCode: i am god
        comments: no comment
        userToken: e36f7ba5-fb5b-41c0-b47c-77c48ab37dd9
        history: null
    }]
}
```
```ruby
[
   {
      "tagId":"a46cfeb6-e175-42db-be62-7f117326ab4e",
      "objectType":"INVOICE_PAYMENT",
      "objectId":"28af3cb9-275b-4ac4-a55d-a0536e479069",
      "tagDefinitionId":"00000000-0000-0000-0000-000000000006",
      "tagDefinitionName":"TEST",
      "auditLogs":[]
   }
]
```
```python
[{'audit_logs': [],
 'object_id': '2a1ffd2c-0de1-4f5c-b2a9-27d8deebe596',
 'object_type': 'PAYMENT',
 'tag_definition_id': '00000000-0000-0000-0000-000000000002',
 'tag_definition_name': 'AUTO_INVOICING_OFF',
 'tag_id': '864ee6aa-1439-4037-8f65-aa114739f09f'}]
```

**Query Parameters**

| Name | Type | Required | Description |
| ---- | -----| -------- | ---- | ------------
| **audit** | enum | false | level of audit logs returned |
| **includedDeleted** | boolean | false | choose true if you want to include deleted tags |

**Returns**

Returns a list of invoice payment tag objects.

### Remove tags from payment

**HTTP Request** 

`DELETE http://example.com/1.0/kb/invoicePayments/{paymentId}/tags`

> Example Request:

```shell
curl -v \
    -X DELETE \
    -u admin:password \
    -H 'X-Killbill-ApiKey: bob' \
    -H 'X-Killbill-ApiSecret: lazar' \
    -H 'X-Killbill-CreatedBy: demo' \
    'http://127.0.0.1:8080/1.0/kb/invoicePayments/cc7fcd4d-e701-4679-9741-41289103db83/tags?tagDef=00000000-0000-0000-0000-000000000001' 	
```

```java
import org.killbill.billing.client.api.gen.InvoicePaymentApi;
protected InvoicePaymentApi invoicePaymentApi;

UUID paymentId = UUID.fromString("e659f0f3-745c-46d5-953c-28fe9282fc7d");

UUID autoPayOffId = UUID.fromString("00000000-0000-0000-0000-000000000001");

invoicePaymentApi.deleteInvoicePaymentTags(paymentId, 
                                           ImmutableList.<UUID>of(autoPayOffId), 
                                           requestOptions);
```

```ruby
tag_name = 'TEST'

invoice_payment.remove_tag(tag_name,
                           user,
                           reason,
                           comment,
                           options)
```

```python
invoicePaymentApi = killbill.api.InvoicePaymentApi()
payment_id = '8d85a8e8-c94b-438f-aac1-e8cb436b2c05'
tag = ["00000000-0000-0000-0000-000000000002"]

invoicePaymentApi.delete_invoice_payment_tags(payment_id, 
                                              created_by, 
                                              api_key, 
                                              api_secret, 
                                              tag_def=tag)
```
> Example Response:

```shell
# Subset of headers returned when specifying -v curl option
< HTTP/1.1 204 No Content
< Content-Type: application/json
< Content-Length: 0
```

```java
no content
```
```ruby
no content
```
```python
no content
```

**Query Parameters**

| Name | Type | Required | Description |
| ---- | -----| -------- | ---- | ------------
| **tagDef** | string | true |  list with tag definition id's that you want to remove it |

**Returns**

A `204` http status without content.